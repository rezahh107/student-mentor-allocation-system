@echo off
chcp 65001 >nul
title Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§
color 0A
cd /d "%~dp0"

echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘     Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†ÛŒØ§Ø²                â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo ðŸŒ Ø¨Ø±Ø±Ø³ÛŒ Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª...
ping -n 1 pypi.org >nul 2>&1
if errorlevel 1 (
    echo âš ï¸ Ù‡Ø´Ø¯Ø§Ø±: Ø§ØªØµØ§Ù„ Ø¨Ù‡ pypi.org Ø¨Ø±Ù‚Ø±Ø§Ø± Ù†ÛŒØ³Øª
    echo    Ù†ØµØ¨ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ø¨Ø§ Ø®Ø·Ø§ Ù…ÙˆØ§Ø¬Ù‡ Ø´ÙˆØ¯
    timeout /t 3 >nul
)

REM Check Python
python --version >nul 2>&1
if errorlevel 1 (
    echo âŒ Ø®Ø·Ø§: Ù¾Ø§ÛŒØªÙˆÙ† Ù†ØµØ¨ Ù†ÛŒØ³Øª!
    echo.
    echo ðŸ’¡ Ø±Ø§Ù‡Ù†Ù…Ø§:
    echo    1. Ø§Ø² https://www.python.org/downloads/ Ø¢Ø®Ø±ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø±Ø§ Ø¯Ø§Ù†Ù„ÙˆØ¯ Ú©Ù†ÛŒØ¯
    echo    2. Ù‡Ù†Ú¯Ø§Ù… Ù†ØµØ¨ ØªÛŒÚ© "Add Python to PATH" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯
    echo    3. Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø±Ø§ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
    pause
    exit /b 1
)

for /f "tokens=*" %%i in ('python --version') do set PYVER=%%i
echo âœ… Ù¾Ø§ÛŒØªÙˆÙ† Ø´Ù†Ø§Ø³Ø§ÛŒÛŒ Ø´Ø¯: %PYVER%
echo.

REM Python version check (>=3.11)
python -c "import sys; sys.exit(0 if sys.version_info >= (3,11) else 1)" >nul 2>&1
if errorlevel 1 (
    echo âš ï¸ Ù‡Ø´Ø¯Ø§Ø±: Ù†Ø³Ø®Ù‡ Ù¾Ø§ÛŒØªÙˆÙ† Ø´Ù…Ø§ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² 3.11 Ø§Ø³Øª
    echo    Ø¨Ø±Ø§ÛŒ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¨Ù‡ØªØ±ØŒ Ù¾Ø§ÛŒØªÙˆÙ† 3.11+ ØªÙˆØµÛŒÙ‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯
    choice /C YN /M "Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¨Ø§ Ù‡Ù…ÛŒÙ† Ù†Ø³Ø®Ù‡ Ø§Ø¯Ø§Ù…Ù‡ Ø¯Ù‡ÛŒØ¯ØŸ (Y/N)"
    if errorlevel 2 exit /b 1
)

REM Quick presence check (fastapi sentinel)
python -c "import fastapi" >nul 2>&1
if not errorlevel 1 (
    echo.
    echo âš ï¸ Ø¨Ù‡ Ù†Ø¸Ø± Ù…ÛŒâ€ŒØ±Ø³Ø¯ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ Ù‚Ø¨Ù„Ø§Ù‹ Ù†ØµØ¨ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯.
    echo.
    choice /C YN /M "Ø¢ÛŒØ§ Ù…ÛŒâ€ŒØ®ÙˆØ§Ù‡ÛŒØ¯ Ø¯ÙˆØ¨Ø§Ø±Ù‡ Ù†ØµØ¨ Ú©Ù†ÛŒØ¯ (Ø¨Ø±Ø§ÛŒ Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ)ØŸ (Y/N)"
    if errorlevel 2 (
        echo.
        echo âœ… Ù†ØµØ¨ Ù„ØºÙˆ Ø´Ø¯. Ø§Ø² Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ù…ÛŒâ€ŒØ´ÙˆØ¯.
        timeout /t 2 >nul
        exit /b 0
    )
)

echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo ðŸ“¦ Ø´Ø±ÙˆØ¹ Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§...
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo [1/3] Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ pip...
python -m pip install --upgrade pip --quiet
if errorlevel 1 (
    echo âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ pip
    echo ðŸ’¡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø¬Ø±Ø§ÛŒ Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø¨Ø§ "Run as Administrator" Ø¨Ø§Ø´Ø¯
    pause
    exit /b 1
)
echo âœ… pip Ø¨Ù‡â€ŒØ±ÙˆØ² Ø´Ø¯

echo.
echo [2/3] Ù†ØµØ¨ wheel Ùˆ setuptools...
python -m pip install --upgrade wheel setuptools --quiet
echo âœ… Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù†ØµØ¨ Ø¢Ù…Ø§Ø¯Ù‡ Ø´Ø¯Ù†Ø¯

echo.
echo [3/3] Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø±ÙˆÚ˜Ù‡...
echo â±ï¸ Ø§ÛŒÙ† Ù…Ø±Ø­Ù„Ù‡ Ù…Ù…Ú©Ù† Ø§Ø³Øª Û³-Ûµ Ø¯Ù‚ÛŒÙ‚Ù‡ Ø·ÙˆÙ„ Ø¨Ú©Ø´Ø¯
echo.

pip install -r requirements.txt
if errorlevel 1 (
    echo.
    echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo âŒ Ø®Ø·Ø§ Ø¯Ø± Ù†ØµØ¨ Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡â€ŒÙ‡Ø§
    echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    echo.
    echo ðŸ’¡ Ø±Ø§Ù‡â€ŒØ­Ù„â€ŒÙ‡Ø§ÛŒ Ù…Ù…Ú©Ù†:
    echo    1. Ø§ØªØµØ§Ù„ Ø§ÛŒÙ†ØªØ±Ù†Øª Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯
    echo    2. ÙØ§ÛŒÙ„ requirements.txt Ø±Ø§ Ø¨Ø±Ø±Ø³ÛŒ Ú©Ù†ÛŒØ¯
    echo    3. Ø§ÛŒÙ† ÙØ§ÛŒÙ„ Ø±Ø§ Ø¨Ø§ "Run as Administrator" Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
    echo    4. ÙØ§ÛŒÙ„ check_progress.py Ø±Ø§ Ø¨Ø±Ø§ÛŒ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ± Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
    echo    5. Ø¯Ø³ØªÙˆØ± Ø²ÛŒØ± Ø±Ø§ Ø¯Ø³ØªÛŒ Ø¯Ø± CMD Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯:
    echo       pip install -r requirements.txt --verbose
    pause
    exit /b 1
)

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘  âœ… Ù†ØµØ¨ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú©Ø§Ù…Ù„ Ø´Ø¯!                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.
echo ðŸŽ¯ Ù…Ø±Ø­Ù„Ù‡ Ø¨Ø¹Ø¯ÛŒ:
echo    1. ÙØ§ÛŒÙ„ check_progress.py Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯ (Ø¨Ø±Ø§ÛŒ ØªØ£ÛŒÛŒØ¯)
echo    2. ÙØ§ÛŒÙ„ run_application.bat Ø±Ø§ Ø§Ø¬Ø±Ø§ Ú©Ù†ÛŒØ¯
echo.
timeout /t 5 >nul
