# راهنمای تست رابط کاربری (PyQt5)

این سند نحوه اجرای تست‌های خودکار UI و چک‌لیست تست دستی را ارائه می‌دهد.

## پیش‌نیازها
- نصب وابستگی‌ها: `make init`
- اطمینان از وجود فونت‌های فارسی در `assets/fonts/` (اختیاری اما توصیه‌شده)

## تست‌های خودکار
- اجرای همه تست‌های UI:
```
pytest tests/ui
```
- اجرای تست‌های realtime:
```
pytest -m realtime
```
- اجرای UI + Integration:
```
pytest tests/ui tests/integration --qt
```

## سناریوهای پوشش‌داده‌شده
- داشبورد: بارگذاری داده، بروزرسانی کارت‌ها و نمودارها، خروجی PDF.
- دانش‌آموزان: لود، فیلتر، افزودن، انتخاب گروهی، خروجی انتخاب‌ها، قالب ورود و ورود از اکسل.
- Realtime: تحریک بروزرسانی با رویداد.
- RTL و فارسی: راست‌چین بودن و متن‌های فارسی.

## چک‌لیست تست دستی
1. باز کردن برنامه و بررسی راست‌چین بودن منو، نوار ابزار، وضعیت.
2. صفحه داشبورد:
   - تغییر بازه زمانی و مشاهده بروزرسانی نمودارها/کارت‌ها.
   - خروجی PDF و بررسی متن فارسی.
   - چاپ و بررسی پیش‌نمایش.
3. صفحه دانش‌آموزان:
   - فیلترها و جستجو (نام/کدملی/تلفن) با داده فارسی.
   - افزودن دانش‌آموز و اعتبارسنجی.
   - انتخاب گروهی و حذف گروهی.
   - دانلود قالب ورود، تکمیل، ورود و مشاهده نتیجه.
4. خطاها:
   - قطع اتصال شبکه (در حالت Real)، مشاهده پیام خطا و ادامهٔ کار.
   - ورود داده نامعتبر و مشاهده پیام مناسب.
5. Realtime:
   - راه‌اندازی WebSocket و بررسی بروزرسانی خودکار داشبورد.

## نکات
- تست‌ها از `pytest-qt` برای تعامل با PyQt و `pytest-asyncio` برای async استفاده می‌کنند.
- برای خروجی PDF بهتر، فونت `assets/fonts/Vazir.ttf` را قرار دهید.
- در مسیر CI ویندوز، آماده‌بودن UI از طریق درخواست `HEAD /ui` (کد ۲۰۰) به‌صورت بدون‌رندر بررسی می‌شود.

